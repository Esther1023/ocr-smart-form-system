# 智能表单填充功能安装指南

## 功能概述

智能表单填充功能已成功集成到甲方基本信息部分，替换了原有的粘贴变量信息功能。新功能支持：

- 📷 图片拖拽和粘贴上传
- 🔍 OCR文字识别（支持中英文）
- 🎯 智能字段匹配
- ✏️ 用户确认和编辑
- 🚀 一键应用到表单

## 安装依赖

### 1. Python依赖包

```bash
pip install pytesseract pillow opencv-python
```

### 2. Tesseract OCR引擎

#### macOS安装：
```bash
# 使用Homebrew安装
brew install tesseract

# 安装中文语言包
brew install tesseract-lang
```

#### 验证安装：
```bash
tesseract --version
tesseract --list-langs
```

确保输出中包含 `chi_sim`（简体中文）和 `eng`（英文）。

## 功能使用说明

### 1. 上传图片
- **拖拽上传**：将图片文件拖拽到上传区域
- **点击上传**：点击上传区域选择文件
- **粘贴上传**：使用 Ctrl+V (Windows) 或 Cmd+V (Mac) 粘贴剪贴板中的截图

### 2. 图片识别
- 上传图片后点击"开始识别"按钮
- 系统会自动进行OCR文字识别
- 识别完成后显示结果

### 3. 结果确认
- 查看识别到的字段和内容
- 可以编辑任何识别错误的字段
- 点击"应用到表单"将内容填入相应字段

### 4. 支持的字段
- 公司名称
- 税号
- 注册地址
- 注册电话
- 开户行
- 银行账号
- 联系人
- 联系电话
- 邮寄地址
- 简道云账号

## 测试功能

运行测试脚本验证OCR功能：

```bash
python test_ocr.py
```

## 技术实现

### 后端 (Python)
- **OCR引擎**：Tesseract OCR
- **图像处理**：OpenCV + Pillow
- **文本解析**：正则表达式 + 智能匹配算法
- **API接口**：Flask路由 `/ocr_process`

### 前端 (JavaScript)
- **文件上传**：File API + FormData
- **拖拽支持**：HTML5 Drag & Drop API
- **粘贴支持**：Clipboard API
- **用户界面**：响应式设计 + 动画效果

### 智能匹配算法
- 支持多种字段名称表达方式
- 模糊匹配和精确匹配结合
- 常见OCR错误自动修正
- 多种分隔符支持（：、:、=等）

## 故障排除

### 1. OCR识别率低
- 确保图片清晰度足够
- 避免倾斜或扭曲的图片
- 确保文字对比度足够

### 2. 中文识别问题
- 确认已安装中文语言包：`brew install tesseract-lang`
- 检查语言包：`tesseract --list-langs`

### 3. 依赖安装问题
- 确保Python版本 >= 3.7
- 在虚拟环境中安装依赖
- 检查系统PATH设置

### 4. 文件上传限制
- 支持格式：PNG、JPG、JPEG、GIF、BMP、WebP
- 最大文件大小：10MB
- 建议图片分辨率：300-600 DPI

## 性能优化建议

1. **图片预处理**：自动调整对比度和清晰度
2. **缓存机制**：避免重复识别相同图片
3. **异步处理**：大文件异步上传和处理
4. **错误重试**：网络错误自动重试机制

## 更新日志

### v1.0.0 (2025-06-30)
- ✅ 完成基础OCR功能开发
- ✅ 集成智能字段匹配算法
- ✅ 实现前端交互界面
- ✅ 添加用户确认和编辑功能
- ✅ 完成样式和用户体验优化

## 联系支持

如有问题请联系开发团队或查看项目文档。
